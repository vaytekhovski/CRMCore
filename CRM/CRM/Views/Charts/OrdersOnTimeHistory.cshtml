@{
    ViewBag.Title = "OrdersOnTimeHistory";

}

@section Scripts{ 

<script src="~/js/plotly-latest.min.js"></script>
<script type="text/javascript">

        CHART = document.getElementById('Chart');

        var Dates = [];
        var Values = [];

    var Green = [];
    var gValues = [];
    var Red = [];
    var rValues = [];


        @foreach (var item in Model.Indicators)
        {
            <text>
            Dates.push(new Date(@item.Time));
            </text>

            }

        @foreach (var item in Model.Indicators)
        {
            <text>
            Values.push(parseFloat(@item.Value));
            </text>

            }

        @foreach (var item in Model.GreenTimes)
                {
            <text>
    Green.push(new Date(@item));
    gValues.push(parseFloat(@ViewBag.MaxValue));
            </text>

            }

        @foreach (var item in Model.RedTimes)
                {
            <text>
    Red.push(new Date(@item));
    rValues.push(parseFloat(@ViewBag.MaxValue));
            </text>

            }



        var RSI = {
            x: Dates,
            y: Values,
            type: 'scatter',
            name: 'Курс'
        };

        var green = {
            x: Green,
            y: gValues,
            type: 'bar',
	marker: {
        color: 'rgba(31, 133, 0, 0.5)',
        size: 22
            },
    name: 'Прибыльные сделки'
        };

        var red = {
            x: Red,
            y: rValues,
         type: 'bar',
	marker: {
        color: 'rgba(255, 20, 20, 0.5)',
        size: 22
	},
            name: 'Убыточные сделки'
    };


    var layout = {
      height: 800
    };


        var data = [RSI,green,red];

        Plotly.plot(CHART, data, layout);


</script>
    }


@model CRM.ViewModels.Charts.OrdersOnTimeHistoryViewModel

@Html.Partial("_OrdersOnTimeHistoryFilterPanel")

<div class="content">

    @Html.ValidationSummary()

    <div id="Chart" style="display: @(Model.Indicators.Count != 0 ? "block" : "none")">
    </div>

</div>
